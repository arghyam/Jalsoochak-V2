server:
  http_listen_port: ${PROMTAIL_HTTP_PORT:-9080}
  # Example:
  # PROMTAIL_HTTP_PORT=9081
  grpc_listen_port: 0

positions:
  filename: ${PROMTAIL_POSITIONS_FILE:-/tmp/positions.yml}
  # Example:
  # PROMTAIL_POSITIONS_FILE=/tmp/promtail-positions-dev.yml

clients:
  - url: ${LOKI_PUSH_URL:-http://loki:3100/loki/api/v1/push}
    # Local default:
    # LOKI_PUSH_URL=http://loki:3100/loki/api/v1/push
    # Dev example:
    # LOKI_PUSH_URL=https://dev-logs.example.com/loki/api/v1/push
    # Prod example:
    # LOKI_PUSH_URL=https://prod-logs.example.com/loki/api/v1/push
    basic_auth:
      username: ${LOKI_USERNAME:-}
      # Example:
      # LOKI_USERNAME=tenant-username
      password: ${LOKI_PASSWORD:-}
      # Example:
      # LOKI_PASSWORD=secret-token
    headers:
      X-Scope-OrgID: ${LOKI_TENANT_ID:-}
      # Example:
      # LOKI_TENANT_ID=dev-tenant-id

scrape_configs:
  - job_name: tenant-service-logs
    pipeline_stages:
      - regex:
          expression: ".*service=(?P<service>[A-Za-z0-9\\-]+).*"
      - labels:
          service:
    static_configs:
      - targets:
          - localhost
        labels:
          app: backend-services
          env: ${LOG_ENV:-local}
          # Local default:
          # LOG_ENV=local
          # Dev example:
          # LOG_ENV=dev
          # Prod example:
          # LOG_ENV=prod
          __path__: ${BACKEND_LOG_PATH:-/var/log/backend/backend-services.log}
          # Local default:
          # BACKEND_LOG_PATH=/var/log/backend/backend-services.log
          # Dev/Prod example:
          # BACKEND_LOG_PATH=/var/log/backend/backend-services.log
